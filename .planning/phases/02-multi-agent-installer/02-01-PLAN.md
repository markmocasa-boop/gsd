# Plan: Multi-Agent Installer

**Phase:** 2 — Multi-Agent Installer
**Plan:** 02-01
**Objective:** Modify install.js to support both Claude Code and OpenCode platforms

---

## Context

@docs/claude/opencode-mapping.md
@bin/install.js

**Key findings from Phase 1:**
- OpenCode uses `.opencode/command/` for commands (vs `.claude/commands/`)
- OpenCode uses `~/.config/opencode/` for global installs (vs `~/.claude/`)
- OpenCode frontmatter: remove `name`, `argument-hint`, `allowed-tools` fields
- Path references: `~/.claude/` → `~/.config/opencode/`

---

## Tasks

### Task 1: Add Platform Selection

**What:** Add platform prompt and configure directory paths for each platform.

**Implementation:**
1. Add `--platform` CLI argument (`claude-code` or `opencode`)
2. Add interactive platform selection prompt when no flag provided
3. Configure platform-specific directories:
   - **Claude Code (existing):**
     - Global: `~/.claude/`
     - Local: `./.claude/`
     - Commands: `commands/gsd/`
     - Framework: `get-shit-done/`
   - **OpenCode (new):**
     - Global: `~/.config/opencode/`
     - Local: `.opencode/`
     - Commands: `command/gsd/` (singular!)
     - Framework: `gsd/`

4. Update banner to show multi-platform support
5. Update help text with `--platform` option

**Files:**
- `bin/install.js`

**Verification:**
- `node bin/install.js --help` shows platform options
- `node bin/install.js --platform claude-code --local` installs to `.claude/`
- `node bin/install.js --platform opencode --local` installs to `.opencode/`

---

### Task 2: Implement OpenCode Content Transformation

**What:** Transform Claude Code files to OpenCode format during installation.

**Implementation:**
1. Add `transformForOpenCode(content)` function that:
   - Removes `name:` frontmatter line
   - Removes `argument-hint:` frontmatter line
   - Removes `allowed-tools:` block (multiline YAML array)
   - Keeps `description:` line
   - Cleans up empty frontmatter (if only `---\n---` remains, add minimal description)

2. Add path substitution for OpenCode:
   - `~/.claude/get-shit-done/` → `~/.config/opencode/gsd/`
   - `./.claude/get-shit-done/` → `.opencode/gsd/`
   - `~/.claude/commands/` → `~/.config/opencode/command/`
   - `./.claude/commands/` → `.opencode/command/`

3. Update `copyWithPathReplacement()` to:
   - Accept `platform` parameter
   - Apply transformation when `platform === 'opencode'`
   - Chain: transform content → replace paths → write file

**Files:**
- `bin/install.js`

**Verification:**
- Install to OpenCode local: commands have no `name:`, `argument-hint:`, `allowed-tools:`
- Paths in installed files reference `.opencode/` and `~/.config/opencode/`
- Claude Code install unchanged (regression test)

---

### Task 3: Update Package Metadata

**What:** Update package.json description and README references for multi-platform.

**Implementation:**
1. Update `package.json`:
   - `description`: mention both Claude Code and OpenCode
   - Ensure `bin` entry still works

2. Verify npm package name remains `get-shit-done-cc` (no change needed)

**Files:**
- `package.json`

**Verification:**
- `npm pack` succeeds
- Package description reflects multi-platform support

---

## Success Criteria

- [ ] `npx get-shit-done-cc` prompts for platform selection
- [ ] `--platform claude-code` installs to Claude Code directories (backwards compatible)
- [ ] `--platform opencode` installs to OpenCode directories with transformed content
- [ ] OpenCode commands have stripped frontmatter (no `name`, `argument-hint`, `allowed-tools`)
- [ ] OpenCode paths use `.opencode/` and `~/.config/opencode/`
- [ ] Existing Claude Code installs work unchanged (no regression)

---

## Commits

1. `feat(02-01): add platform selection to installer`
2. `feat(02-01): implement OpenCode content transformation`
3. `chore(02-01): update package metadata for multi-platform`
4. `docs(02-01): complete multi-agent installer plan`
