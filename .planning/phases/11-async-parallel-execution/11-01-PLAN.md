---
phase: 11-async-parallel-execution
plan: 01
type: execute
---

<objective>
Create async execution foundation with /gsd:execute-async and /gsd:status commands.

Purpose: Enable non-blocking plan execution using Task tool's run_in_background parameter, with status monitoring for background agents.
Output: Two new slash commands (/gsd:execute-async, /gsd:status), extended agent-history schema for background tracking.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Phase 10 provides agent tracking infrastructure:
@.planning/phases/10-subagent-resume/10-01-SUMMARY.md
@.planning/phases/10-subagent-resume/10-02-SUMMARY.md

# Key files to extend:
@get-shit-done/templates/agent-history.md
@commands/gsd/execute-plan.md

**Tech stack available:** Task tool with run_in_background parameter, TaskOutput tool for checking results
**Established patterns:** Agent ID capture in execute-phase workflow, current-agent-id.txt for quick lookup
**Constraining decisions:**
- Phase 10: Dual storage (current-agent-id.txt + agent-history.json)
- Phase 10: Status lifecycle: spawned → completed/interrupted → resumed
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend agent-history schema for background execution</name>
  <files>get-shit-done/templates/agent-history.md</files>
  <action>
    Add new fields to support background execution tracking:
    - `execution_mode`: "foreground" | "background" - distinguishes sync vs async execution
    - `output_file`: string | null - path to output file for background agents (from Task tool response)
    - `background_status`: "running" | "completed" | "failed" | null - status from TaskOutput checks

    Update the Entry Schema section with these fields.
    Add examples showing background agent entries.
    Keep backwards compatible - foreground entries can omit new fields.
  </action>
  <verify>agent-history.md contains new fields with documentation</verify>
  <done>Schema documented with execution_mode, output_file, and background_status fields</done>
</task>

<task type="auto">
  <name>Task 2: Create /gsd:execute-async command</name>
  <files>commands/gsd/execute-async.md</files>
  <action>
    Create new slash command that:
    1. Accepts path to PLAN.md as argument (like execute-plan)
    2. Validates plan exists and hasn't been executed (no SUMMARY.md)
    3. Uses Task tool with run_in_background: true
    4. Records agent_id and output_file to agent-history.json with execution_mode: "background"
    5. Returns immediately with agent ID and instructions to check status

    Command structure following GSD patterns:
    - Frontmatter with name, description, allowed-tools
    - Delegates to workflow for actual execution logic
    - Clear success criteria

    Output should show:
    ```
    ⚡ Background execution started
    Agent ID: agent_01HXXXX...
    Output file: /path/to/output

    Check status: /gsd:status
    ```
  </action>
  <verify>commands/gsd/execute-async.md exists with proper GSD command structure</verify>
  <done>Command accepts plan path, spawns background agent, returns immediately with tracking info</done>
</task>

<task type="auto">
  <name>Task 3: Create /gsd:status command</name>
  <files>commands/gsd/status.md</files>
  <action>
    Create new slash command that:
    1. Reads agent-history.json for recent entries
    2. For background agents (execution_mode: "background"):
       - Uses TaskOutput tool with block: false to check current status
       - Shows running/completed status
       - If completed, shows summary of results
    3. Displays table format:
       ```
       Background Tasks:
       | Agent ID | Plan | Status | Started |
       |----------|------|--------|---------|
       | agent_01H... | 11-01 | Running | 2 min ago |

       Use /gsd:status <agent-id> for details
       ```
    4. With agent-id argument: shows full output from that agent

    Use TaskOutput tool parameters:
    - task_id: agent_id from history
    - block: false (non-blocking check)
    - timeout: 1000 (quick check)
  </action>
  <verify>commands/gsd/status.md exists with TaskOutput integration</verify>
  <done>Command shows background agent statuses and can fetch detailed output</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] agent-history.md has background execution fields documented
- [ ] /gsd:execute-async command exists and follows GSD patterns
- [ ] /gsd:status command exists and uses TaskOutput for status checks
- [ ] Commands reference each other appropriately (execute-async mentions status)
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Commands are consistent with existing GSD command patterns
- Background execution flow is clearly documented
</success_criteria>

<output>
After completion, create `.planning/phases/11-async-parallel-execution/11-01-SUMMARY.md`:

# Phase 11 Plan 01: Async Execution Foundation Summary

**[Substantive one-liner describing what shipped]**

## Accomplishments
- Extended agent-history schema for background tracking
- Created /gsd:execute-async command for non-blocking execution
- Created /gsd:status command for monitoring background agents

## Files Created/Modified
- `get-shit-done/templates/agent-history.md` - Added background execution fields
- `commands/gsd/execute-async.md` - New command for async plan execution
- `commands/gsd/status.md` - New command for status monitoring

## Decisions Made
[Key decisions and rationale]

## Issues Encountered
[Problems and resolutions, or "None"]

## Next Phase Readiness
Ready for 11-02: Parallel Phase Execution
</output>
