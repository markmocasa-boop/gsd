---
phase: 01-constitution-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - ~/.claude/get-shit-done/templates/constitution/global-constitution.md
  - ~/.claude/get-shit-done/templates/constitution/project-constitution.md
  - get-shit-done/templates/constitution/global-constitution.md
  - get-shit-done/templates/constitution/project-constitution.md
autonomous: true

must_haves:
  truths:
    - "Global CONSTITUTION.md template exists with severity sections"
    - "Project CONSTITUTION.md template exists for overrides"
    - "TDD-01 rule documented with examples"
    - "Security rules (SEC-01 through SEC-07) documented with examples"
    - "Each rule has rationale explaining why it exists"
    - "Templates tested in GSD install location before repo updated"
  artifacts:
    - path: "~/.claude/get-shit-done/templates/constitution/global-constitution.md"
      provides: "Global constitution template (testing)"
      contains: "# NON-NEGOTIABLE"
      min_lines: 200
    - path: "get-shit-done/templates/constitution/global-constitution.md"
      provides: "Global constitution template (repo source)"
      contains: "# NON-NEGOTIABLE"
      min_lines: 200
    - path: "~/.claude/get-shit-done/templates/constitution/project-constitution.md"
      provides: "Project constitution template (testing)"
      contains: "version:"
      min_lines: 30
    - path: "get-shit-done/templates/constitution/project-constitution.md"
      provides: "Project constitution template (repo source)"
      contains: "version:"
      min_lines: 30
  key_links:
    - from: "~/.claude/get-shit-done/templates/constitution/global-constitution.md"
      to: "TDD-01 rule definition"
      via: "### TDD-01: heading with good/bad examples"
      pattern: "### TDD-01:"
---

<objective>
Create constitution file templates defining structure, severity levels, and initial TDD enforcement rule. Test in GSD install location, then update repo source.

Purpose: Establish constitutional file format that will be loaded by constitution system. Two-stage approach allows testing in actual GSD environment before committing to source control.

Output: Constitution templates working in GSD install, source files updated in repo.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md

**Two-stage approach:**
1. Create/modify files in ~/.claude/get-shit-done/ (installed GSD location)
2. Test in actual GSD environment
3. Copy working files to repo source (get-shit-done/)
4. Commit repo changes to git
</execution_context>

<context>
@/Users/maciejmoszoro/Projects/GSD-with-constitution/get-shit-done-mm/.planning/PROJECT.md
@/Users/maciejmoszoro/Projects/GSD-with-constitution/get-shit-done-mm/.planning/ROADMAP.md
@/Users/maciejmoszoro/Projects/GSD-with-constitution/get-shit-done-mm/.planning/STATE.md
@/Users/maciejmoszoro/Projects/GSD-with-constitution/get-shit-done-mm/.planning/REQUIREMENTS.md
@/Users/maciejmoszoro/Projects/GSD-with-constitution/get-shit-done-mm/.planning/phases/01-constitution-foundation/01-CONTEXT.md
@/Users/maciejmoszoro/Projects/GSD-with-constitution/get-shit-done-mm/.planning/phases/01-constitution-foundation/01-RESEARCH.md
@/Users/maciejmoszoro/Projects/GSD-with-constitution/get-shit-done-mm/.planning/codebase/STRUCTURE.md
@/Users/maciejmoszoro/Projects/GSD-with-constitution/get-shit-done-mm/.planning/codebase/CONVENTIONS.md
</context>

<tasks>

<task type="auto">
  <name>Stage 1: Create global constitution template in GSD install location</name>
  <files>~/.claude/get-shit-done/templates/constitution/global-constitution.md</files>
  <action>
Create global CONSTITUTION.md template at `~/.claude/get-shit-done/templates/constitution/global-constitution.md`.

Structure:
1. YAML frontmatter with version (1.0.0), lastUpdated placeholder
2. Introduction explaining constitution purpose
3. Three severity sections as H1 headers: `# NON-NEGOTIABLE`, `# ERROR`, `# WARNING`
4. Rules distributed by severity (see below)

NON-NEGOTIABLE rules (cannot be overridden, blocks verification):
- **TDD-01: Test before implementation** - Test file must exist and be committed before corresponding implementation file
- **SEC-01: No hardcoded secrets** - API keys, passwords, tokens must use environment variables or secure vaults, never hardcoded in code
- **SEC-02: Parameterized queries only** - Database queries must use parameterized statements to prevent SQL injection, never string concatenation

ERROR rules (blocks verification but can be overridden with justification):
- **SEC-03: Input validation required** - All user input must be validated (type, format, range, length) before processing
- **SEC-04: Output sanitization required** - All user-controlled data rendered in UI must be sanitized to prevent XSS attacks
- **SEC-05: Authentication/authorization checks** - Protected resources must verify user identity and permissions before access

WARNING rules (reported but doesn't block):
- **SEC-06: Secure dependency management** - Dependencies must be from trusted sources, regularly updated, vulnerability-scanned
- **SEC-07: No sensitive data exposure** - Error messages, logs, responses must not leak passwords, tokens, PII, internal paths

Each rule format:
- Rule heading: `### RULE-ID: Short description`
- Description: What the rule requires
- Rationale: Why this rule exists, what failures it prevents
- `## Good Example` with passing scenario
- `## Bad Example` with violation scenario
- Code blocks demonstrating compliance vs violation

Anti-pattern documentation (DOC-01, DOC-04):
- Each rule must have "Why this rule exists" explanation
- Include specific failure modes prevented by rule
- Reference executor context limits, verification constraints

GSD style integration (DOC-03):
- Imperative voice in rule descriptions
- Technical precision in examples
- No filler words or emojis

Follow CONTEXT.md decisions for format (YAML frontmatter, markdown body, severity hierarchy).

Create directory if needed: `mkdir -p ~/.claude/get-shit-done/templates/constitution`
  </action>
  <verify>
File exists at `~/.claude/get-shit-done/templates/constitution/global-constitution.md`.
Contains YAML frontmatter with version field.
Contains three H1 sections: NON-NEGOTIABLE, ERROR, WARNING.
Contains TDD-01 rule with heading, description, rationale, good/bad examples.
Contains SEC-01 and SEC-02 rules under NON-NEGOTIABLE section.
Contains SEC-03, SEC-04, SEC-05 rules under ERROR section.
Contains SEC-06, SEC-07 rules under WARNING section.
All rules have rationale and examples.
`wc -l ~/.claude/get-shit-done/templates/constitution/global-constitution.md` shows >= 200 lines.
  </verify>
  <done>
Global constitution template created in GSD install location for testing.
Template includes versioning, severity sections, TDD-01 rule, and 7 security rules with rationale and examples.
Ready for testing in actual GSD environment.
  </done>
</task>

<task type="auto">
  <name>Stage 1: Create project constitution template in GSD install location</name>
  <files>~/.claude/get-shit-done/templates/constitution/project-constitution.md</files>
  <action>
Create project CONSTITUTION.md template at `~/.claude/get-shit-done/templates/constitution/project-constitution.md`.

Structure:
1. YAML frontmatter with version (1.0.0), lastUpdated placeholder
2. Introduction explaining project constitutions extend/override global
3. Same three severity sections as global (NON-NEGOTIABLE, ERROR, WARNING)
4. Placeholder comments in each section showing override syntax
5. Example override rule (commented out) demonstrating rule ID format

Content:
- Frontmatter identical to global template (version, lastUpdated)
- Introduction: "Project constitution extends global CONSTITUTION.md. Rules defined here override global rules with matching IDs."
- Each severity section contains commented example: `<!-- ### PROJ-01: Project-specific rule -->`
- Override precedence explanation: "Project rules with same ID as global rules replace global definition"
- Empty sections by default (projects add rules as needed)

Keep minimal (30-40 lines) - project constitutions are opt-in extensions, not full duplicates.

Follow same format conventions as global template.

Create in same directory as global template (already exists from previous task).
  </action>
  <verify>
File exists at `~/.claude/get-shit-done/templates/constitution/project-constitution.md`.
Contains YAML frontmatter with version field.
Contains three H1 sections matching global template.
Contains commented examples showing override syntax.
Explains project override precedence.
`wc -l ~/.claude/get-shit-done/templates/constitution/project-constitution.md` shows >= 30 lines.
  </verify>
  <done>
Project constitution template created in GSD install location for testing.
Template provides structure for project-specific rules.
Clearly documents override behavior.
Ready for testing in actual GSD environment.
  </done>
</task>

<task type="auto">
  <name>Stage 2: Copy working templates to repo source</name>
  <files>
    get-shit-done/templates/constitution/global-constitution.md
    get-shit-done/templates/constitution/project-constitution.md
  </files>
  <action>
After verifying templates work in GSD install location, copy them to repo source for git tracking.

Steps:
1. Create repo source directory:
```bash
mkdir -p get-shit-done/templates/constitution
```

2. Copy tested templates from GSD install to repo:
```bash
cp ~/.claude/get-shit-done/templates/constitution/global-constitution.md get-shit-done/templates/constitution/
cp ~/.claude/get-shit-done/templates/constitution/project-constitution.md get-shit-done/templates/constitution/
```

3. Verify copies match:
```bash
diff ~/.claude/get-shit-done/templates/constitution/global-constitution.md get-shit-done/templates/constitution/global-constitution.md
diff ~/.claude/get-shit-done/templates/constitution/project-constitution.md get-shit-done/templates/constitution/project-constitution.md
```

This ensures repo source matches tested GSD install files exactly.
  </action>
  <verify>
Files exist at:
- `get-shit-done/templates/constitution/global-constitution.md`
- `get-shit-done/templates/constitution/project-constitution.md`

Repo files match GSD install files (diff shows no differences).
Both files tracked by git in repo source.
  </verify>
  <done>
Constitution templates copied from tested GSD install to repo source.
Source files ready for git commit.
Repo source matches working GSD install files.
  </done>
</task>

</tasks>

<verification>
Stage 1 verification (GSD install location):
- Both constitution templates exist in `~/.claude/get-shit-done/templates/constitution/`
- Global template contains complete TDD-01 rule with rationale and examples
- Global template contains 7 security rules (SEC-01 through SEC-07) with rationale and examples
- Project template provides override structure with examples
- Templates follow YAML frontmatter + markdown format from CONTEXT.md
- Line counts: global >= 200, project >= 30

Stage 2 verification (repo source):
- Both templates copied to `get-shit-done/templates/constitution/`
- Repo files match GSD install files exactly (diff confirms)
- Files tracked in git, ready for commit

Requirements coverage:
- CONST-05, SEC-01 through SEC-07, DOC-01, DOC-02, DOC-03, DOC-04 addressed
</verification>

<success_criteria>
- [ ] Global constitution template exists in GSD install with version 1.0.0
- [ ] Project constitution template exists in GSD install with version 1.0.0
- [ ] TDD-01 rule fully documented with good/bad examples
- [ ] SEC-01 through SEC-07 rules fully documented with good/bad examples
- [ ] Each template has three severity sections (NON-NEGOTIABLE, ERROR, WARNING)
- [ ] NON-NEGOTIABLE section includes TDD-01, SEC-01, SEC-02
- [ ] ERROR section includes SEC-03, SEC-04, SEC-05
- [ ] WARNING section includes SEC-06, SEC-07
- [ ] Project template explains override precedence
- [ ] Templates use YAML frontmatter + markdown body format
- [ ] Templates copied to repo source and match GSD install files
- [ ] Code committed with message following project conventions
</success_criteria>

<output>
After completion, create `/Users/maciejmoszoro/Projects/GSD-with-constitution/get-shit-done-mm/.planning/phases/01-constitution-foundation/01-01-SUMMARY.md`
</output>
